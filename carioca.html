<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
	<meta name="author" content="Prakash Prasad" >		
	<script type="text/javascript" >

	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-27962903-1']);
	    _gaq.push(['_setDomainName', 'prakashprasad.com']);
	    _gaq.push(['_trackPageview']);

	    (function () {
	        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	    })();

    </script>
	<link rel="Shortcut Icon" href="http://prakashprasad.com/images/favicon.ico" type="image/x-icon" > 
     <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400|Open+Sans+Condensed:300,300italic&subset=latin,greek,greek-ext,latin-ext" rel="stylesheet" type="text/css" >
	<link href="main.css" rel="stylesheet" type="text/css" >
	<link rel="stylesheet" type="text/css" href="menu_style.css" >
	<link rel="stylesheet" href="Libraries/fancybox/jquery.fancybox-1.3.4.css" type="text/css" media="screen" >
    <link type="text/css" rel="stylesheet" href="Libraries/syntaxhighlighter/styles/shCoreEclipse.css" >
	
	<title>Carioca (UnrealScript) - prakashprasad.com</title>
	
	<script type="text/javascript" src="Libraries/jquery-1.4.3.min.js" ></script>
	<script src="Libraries/fancybox/jquery.fancybox-1.3.4.js" type="text/javascript" ></script>
	<script type="text/javascript" src="Libraries/jwplayer/jwplayer.js" ></script>
    <script type="text/javascript" src="Libraries/syntaxhighlighter/scripts/shCore.js" ></script>
    <script type="text/javascript" src="Libraries/syntaxhighlighter/scripts/shBrushJScript.js" ></script>
	<script type="text/javascript" >	    SyntaxHighlighter.all();</script>
</head>
	<body class="port-body" >

<a href="http://www.prakashprasad.com/blog" target="_blank" ><div class="port-blog" style="left:55px; top:-5px; " ></div></a>

<a href="http://photo.prakashprasad.com" target="_blank" ><div class="port-photo" style="left:115px; top:-5px; " ></div></a>

<div class="port-wrap" >
<div class="port-header" onclick="location.href='index.html';" style="cursor:pointer; " ></div>

<div class="nav-bar-container" >
<ul id="navigation-1" >
		<li><a href="index.html" title="Home" >Home</a></li>
		<li><a href="resume.html" title="Résumé" >Résumé</a></li>
		<li><a href="projects.html" title="Projects" class="navigation-sel" >Projects</a>
			<ul class="navigation-2" >
				<li><a href="projects_as.html" title="Actionscript Projects" >Actionscript</a></li>
				<li><a href="projects_cpp.html" title="C++ Projects" >C++</a></li>
				<li><a href="projects_cs.html" title="C# Projects" >C#</a></li>
				<li><a href="projects_java.html" title="Java Projects" >Java</a></li>
				<li><a href="projects_u3d.html" title="Unity 3D Projects" >Unity 3D</a></li>
				<li><a href="projects_u.html" title="Unrealscript Projects" class="navigation-sel" >Unrealscript</a></li>
			</ul>
		</li>
		<li><a href="contact.html" title="Contact" >Contact</a></li>
</ul>
</div>

<div class="port-block" style="left:0; top:-36px; " >

<h1>Carioca</h1>

<h2>Game Description</h2>
<div class="gamedescription" >
<p>Carioca is a first person RPG which simulates a dangerous Brazilian favela where players can choose the course of actions which suits their self-imposed goals. The game tries to generate an emergent narrative by embedding narrative cues in the environment as well as presenting a tactile gameworld. Via their interaction with the game and its characters, the players can change the meaning of life in the favela - for better or worse.</p>
<p>NPCs as well as players are able to perform certain set of basic actions that can be associated to life in a favela - eat, sleep or recreate. These actions can be performed only in specific spaces like food places (eat), bars (recreation), legal working spaces (legal work), houses (sleep) and garbage heaps (scavenging).</p>
<p>All characters in the game (including the player) are controlled by statistical values that define their needs. For example, a character’s hunger value increases over time making it hungry enough to warrant eating twice a day. In order to satisfy these needs, characters can simply step into a certain kind of space. A hungry bot would eat food by stepping into a food area. According to the type of NPC (civilian, druggie or gangster), they can beat, mug, kill, buy/sell drugs, have legitimate jobs or scavenge among garbage. The action to be performed by NPC is decided by prioritizing its various needs and picking the most important action at that moment.</p>
<p>These actions can be categorized into legal actions (i.e. working in legal places), violent actions (i.e. beatings, killings) or drug related actions (i.e. drug trafficking). The player himself has the possibility to perform any of these actions. These categories are used in order to formulate a visual feedback schema for the game environment. If violent events or drug related acts take place in the game then the environment changes and portrays which category’s actions are performed. If the game world is prosperous (earnings from legal spaces) and the violence/drug-dealing events are at low levels then the environment remains intact and nice looking.</p>
<p>An important element of the game is that NPCs rate their relationships with every other character in the game - including the player. Having good relationships with NPCs can unlock dialogue options and features for the player, while having a bad relationship can result in them not talking to the player at all. Players interact with NPCs through a dialogue system, that has consequences on the player’s and NPC’s stats. For example, the player can talk to a gangster and choose to threaten him, steal money and beat him (repeatedly till death) - all through the dialogue system. The dialogue data is retrieved from a SQLite database depending on the bot type and player stats.</p>
<p>The game simulation is setup in such a way that the gameworld will start spiralling into a violent state. It is left up to the player to choose whether he wants to accelerate that process by taking part in the violence and make money, or try to help the situation and save civilians by donating money to the church. The game however, does not compel the player to do either; he can decide to simply stand around and look at the favela go up in flames (metaphorically speaking).</p>
</div>

<h2>Programming Challenges</h2>
<div class="programmingchallenge" >
<p>While the Unreal Engine provides loads of functionality for the programmers, some of its foundation features are not accessible in the free version (UDK). At times this lack of access hampers developers in understanding the optimal workflow process and loopholes that need to be avoided. One such problem I faced was regarding the use of Navigation Meshes. In the best case scenario, the navigation mesh would work in case of controlling one AI bot. However, when more bots were introduced, the procedure would end up returning an error state for the navigation method. This is an outstanding error and a migration to waypoint based navigation method might come up with better results.</p>
<p>Another big challenge was the use of Scaleform based bot action symbols. Since our development team was highly restricted in its animation skills, some method had to be devised to illustrate the bot’s actions to the player. The solution was to render SWF (Flash) texture on a dynamically spawned static actor over the bot’s head.</p>
</div>

<h2>Features</h2>
<div class="features" >
<ul>
	<li>Game data stored in SQLite database</li>
	<li>Dynamic bot spawning based on number of entities in the game database</li>
	<li>Three different Bot classes - Civilian, Druggie, Gangster</li>
	<li>Six action spaces - Home, Restaurant, Work, Garbage Pile, Bar, Drug Selling Area</li>
	<li>Navigation Mesh based bot pathfinding</li>
	<li>Prioritized bot actions executed using UnrealScript states</li>
	<li>Custom “District” volumes to collect gameplay stats</li>
	<li>SQLite Gameplay logger</li>
	<li>Custom HUD (using Scaleform)</li>
	<li>Scaleform based dialogue screen</li>
	<li>Scaleform based bot action placard</li>
	<li>Church building where player can donate money to reform a criminal bot</li>
</ul>
</div>

<h2>Publications</h2>
	<div class="downloads" >
		<ul>
			<li>Prakash Prasad, Orestis Tsafarakis, Søren E. Andersen. <a href="images/carioca/a96-prasad.pdf" target="_blank" class="red" ><em>Carioca - The Game</em></a>. ACE 2011 - Game Competition. <em>November 2011, Lisbon.</em></li>
		</ul>
	</div>

<h2>Video</h2>
<div class="videotrailer" style="width:720px; " >
	<video src="images/carioca/video/carioca_video.mp4" width="720" height="405" id="container" volume="100" autostart="false" poster="images/carioca/video/poster.png" >
	</video>

	<script type="text/javascript" >
		jwplayer("container").setup({
			flashplayer: "Libraries/jwplayer/player.swf"
		});
	</script>
</div>

<h2>Screenshots</h2>
<div class="screenshots" >

<a rel="Gal-scbwai" title="Carioca spalsh screen" href="images/carioca/Title-screen-suggestion1.png" ><img border="0" alt="" src="images/carioca/thumbs/Title-screen-suggestion1_s.png" ></a>
<a rel="Gal-scbwai" title="Game is setup in Rio de Janeiro; there's Christo Redentor in the background" href="images/carioca/CristoRedentor.png" ><img border="0" alt="" src="images/carioca/thumbs/CristoRedentor_s.png" ></a>
<a rel="Gal-scbwai" title="Mugging, Beating or killing bots causes the environment to be in a violent theme" href="images/carioca/DeadBodyViolentTheme.png" ><img border="0" alt="" src="images/carioca/thumbs/DeadBodyViolentTheme_s.png" ></a>
<a rel="Gal-scbwai" title="The game's dialogue system" href="images/carioca/Dialogue.png" ><img border="0" alt="" src="images/carioca/thumbs/Dialogue_s.png" ></a>
<a rel="Gal-scbwai" title="Donating money to the church can help clean favela" href="images/carioca/Church.png" ><img border="0" alt="" src="images/carioca/thumbs/Church_s.png" ></a>
<a rel="Gal-scbwai" title="Being involved in drug trade induces the environment's drug theme" href="images/carioca/DrugThemeBlueTextures.png" ><img border="0" alt="" src="images/carioca/thumbs/DrugThemeBlueTextures_s.png" ></a>
<a rel="Gal-scbwai" title="Bots mug other bots - contributing to violence in the level" href="images/carioca/Mugging.png" ><img border="0" alt="" src="images/carioca/thumbs/Mugging_s.png" ></a>
<a rel="Gal-scbwai" title="Scaleform HUD test from a flash file" href="images/carioca/hud.png" ><img border="0" alt="" src="images/carioca/thumbs/HUD_s.png" ></a>
<a rel="Gal-scbwai" title="Navigation meshes using Pylons works, but only to an extent" href="images/carioca/NavPylon.png" ><img border="0" alt="" src="images/carioca/thumbs/NavPylon_s.png" ></a>

<script type="text/javascript" >
		$(document).ready(function() {

	$("a[rel=Gal-scbwai]").fancybox({
				'transitionIn'		: 'elastic',
				'transitionOut'		: 'fade',
				'titlePosition' 	: 'over',
				'titleFormat'		: function(title, currentArray, currentIndex, currentOpts) {
					return '<span id="fancybox-title-over">Image ' + (currentIndex + 1) + ' / ' + currentArray.length + (title.length ? ' &nbsp; ' + title : '') + '</span>';
				}
			});
			
		});
	</script>

</div>

<h2>Code Sample</h2>
<p style="margin-right:30px; margin-left:30px; " >Bots populating each game level are stored in the SQLite database. These are loaded on game start and placed at their appropriate home space, as directed by the database entry. Here is the function from unreal's gametype class, which activates each bot by looking it up in the database.</p>
<div class="codeblock" >
<pre class="brush: js;" >function ActivateBots(int aPreFabNumber)
{
    local int id, isalive;
    local string lName, lType, lSex, lHome, lDrugHome;
    local ENPCType eType;
    local float lHealth, lMoney, lFatigue, lDrugDosesTaken, lMenace, lHunger;
    local name lstate;
    local Vector loc, dbloc;

    if( NumBots==0 )
    {
        mDatabase.ClearRowsHistory();
        while(mDatabase.GetNextCharacterInfo(id, lName, lType, lSex, lHealth, lMoney, lFatigue, lDrugDosesTaken, lMenace, lHunger, lHome, lDrugHome, dbloc, isalive, lstate))
        {
            if( dbloc.X==-1 &amp;&amp; dbloc.Y==-1 &amp;&amp; dbloc.Z==-1 )
                loc = GetHomeVectorLocation( name(lHome) );
            else
                loc = dbloc;

            eType = NPCTYPE_All;

            if( loc.X!=0 &amp;&amp; loc.Y!=0 &amp;&amp; loc.Z!=0 )
            {
                switch( Caps(lType) )
                {
                    case "CIVILIAN":
                        eType = NPCTYPE_Civilian;
                        break;
                    case "DRUGGIE":
                        eType = NPCTYPE_Druggie;
                        break;
                    case "POLICE":
                        eType = NPCTYPE_Police;
                        break;
                    case "GANGSTER":
                        eType = NPCTYPE_Gangster;
                        break;
                    case "KINGPIN":
                        eType = NPCTYPE_Kingpin;
                        break;
                }
                if( eType!=NPCTYPE_All )
                    if( isalive==1 )
                        WakeupCarioca( id, lName, eType, lSex, lHealth, lMoney, lFatigue, lDrugDosesTaken, lMenace, lHunger, loc, name(lHome), name(lDrugHome), lstate);
            }
        }
    }
}
</pre></div>

<h2>Download</h2>
	<div class="downloads" >
		<p>Click <a href="downloads/UDK-Carioca.exe" class="red" >here</a> to dowload the playable version of the game</p>
		<p><strong>Installation Instructions:</strong></p>
		<ul>
			<li>Run the downloaded file.</li>
			<li>Follow the onscreen instructions and finish the install process.</li>
			<li>Run <em>"C:\UDK\UDK Carioca\Binaries\Windows\UE3Redist.exe"</em>.</li>
			<li>Run the file <em>"C:\UDK\UDK Carioca\Carioca Masters Thesis Game"</em> to play the game.</li>
			<li>If prompted by EULA agreement, click yes to proceed.</li>
			<li>Once the game has started, you'll see the main menu with 2 button. Both will say "Start Game", but the 1<sup>st</sup> one is to start the game, whereas the 2<sup>nd</sup> button is to quit the game.</li>
			<li>Enjoy the game!</li>
		</ul>
		<p>Click <a href="downloads/ACE2011_Carioca.pdf" target="_blank" class="red" >here</a> to dowload the ACE 2011 paper submitted about the game's narrative model</p>
	</div>
	
<div class="emptygap" >&nbsp;</div>

</div>

<div class="port-footer" style="left:0; top:-48px; " >Prakash Prasad © 2011 <strong><big>&middot;</big></strong> Copenhagen, Denmark <strong><big>&middot;</big></strong> Contact <script type="text/javascript" >document.write('<a href="mailto:'+'p' + 'r' + 'a' + 'k' + 'a' + 's' + 'h' + '@' + 'p' + 'r' + 'a' + 'k' + 'a' + 's' + 'h' + 'p' + 'r' + 'a' + 's' + 'a' + 'd' + '.' + 'c' + 'o' + 'm'+'" class="light" >'+'p' + 'r' + 'a' + 'k' + 'a' + 's' + 'h' + '@' + 'p' + 'r' + 'a' + 'k' + 'a' + 's' + 'h' + 'p' + 'r' + 'a' + 's' + 'a' + 'd' + '.' + 'c' + 'o' + 'm'+'</a>');</script> for more details.</div>

</div>

</body></html>